{% extends "layout.html" %}
{% from "macros/articles.html" import render_post_preview %}
{% from "macros/pagination.html" import render_pagination %}
{% block title %}{{ this.title }}{% endblock %}
{% block body %}

<div class="banner">
  <div class="container">
    <h1>{{ this.title }}</h1>
    {% if this.subtitle %}
    <span>{{ this.subtitle }}</span>
    {% endif %}
  </div>
</div>

<div class="container">

  <div class="intro">
    {{ this.body }}
  </div>

  <div class="article-list">

  {% for t in site.query('/article-types') %}
    {% set children = t.children %}
    {% if children %}
    <div class="article-group">
      <h2 class="type-heading">{{ t.name }}</h2>

      {% for child in children.limit(20) %}
      {{ render_post_preview(child, from_index=true) }}
      {% endfor %}
      {% for child in children.limit(1).offset(20) %}
      <a href="types/{{t._id}}/page/2/" class="btn btn-primary btn-sm">{{ bag('global_content').more }} {{ t.name }}</a>
      {% endfor %}
    </div>

    {% endif %}
  {% endfor %}

  </div>

  {% endblock %}

</div>
